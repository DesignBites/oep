{% extends 'mapper/base.html' %}
{% load i18n static crispy_forms_tags %}


{% block head %}

    <link href="{% static 'tagsinput.css' %}" rel="stylesheet">

{% endblock %}


{% block content %}

<div class="container">

	{% if title %}
		<h2>{{ title|safe }}</h2>
	{% endif %}

	{% if description %}
		<p class="lead">{{ description|safe }}</p>
	{% endif %}

	<form method="post" id="stakeholderForm">
		{% csrf_token %}
		{{ form|crispy }}
		<button type="submit" class="btn btn-primary">{% trans 'Submit' %}</button>
	</form>

</div>

{% endblock %}


{% block js %}

    <script src="{% static 'tagsinput.js' %}"></script>

	<script>

		var confirmed = false;

		$('#stakeholderForm').submit(function(e) {

			if ($("#stakeholderForm input[data-role=tagsinput]").length == 0) {
				var isEmpty = false;
			} else {
				var isEmpty = true;
			}

			$("#stakeholderForm input[data-role=tagsinput]").each(function(i, item) {
				if ($(item).val() != '') {
					isEmpty = false;
					return false;
				};
			});

			if (isEmpty) {
				if (!confirmed) {
					if (!confirm('You did not specify any stakeholders. Are you sure?')) {
						e.preventDefault();
					}
				}
			}
		});

	</script>

{% endblock %}